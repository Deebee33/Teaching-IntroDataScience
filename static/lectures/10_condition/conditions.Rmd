---
title: "if...else..."
author: "Daijiang Li"
date: "9/30/2021"
output: 
  html_document: 
    toc: yes
    highlight: kate
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Control flow

Sometimes, we only want to execute some statements if certain conditions are met; sometimes, we want to execute some statement repetitively for each elements of a dataset or until certain conditions/values reached. This is where control-flow constructs come in. In this week's lectures, we will largely focus on this topic.

For the syntax examples throughout this lecture, keep the following in mind:

- *statement* is a single R statement or a compound statement (a group of R statements enclosed in curly braces `{ }` and separated by semicolons).
- `cond` is an expression that resolves to `TRUE` or `FALSE`.
- `expr` is a statement that evaluates to a number or character string.
- `seq` is a sequence of numbers or character strings.

## Conditional execution

In conditional execution, a statement or statements are only executed if a specified condition is met. These constructs include `if-else`, `ifelse`, and `switch`.

Before we talk about these functions, it is necessary to talk about R's logical operators.

|   Operator |             Description |
| ---------: | ----------------------: |
|        `<` |               less than |
|       `<=` |   less than or equal to |
|        `>` |             larger than |
|       `>=` | larger than or equal to |
|       `==` |        exactly equal to |
|        `!` |             opposite of |
|       `!=` |            not equal to |
|        `|` |                      or |
|        `&` |                     and |
|     `%in%` |                      in |
| `isTRUE()` |             is it true? |

[**Surprise surprise!**](https://stackoverflow.com/questions/9508518/why-are-these-numbers-not-equal)

```{r eval=FALSE}
i = 0.1
i = i + 0.05
i == 0.15 # ? what do you say?
```

# `if ... else ...`

How does an if else statement work in R?

- Two steps: evaluation and execution (which are not necessarily repeated)
- Two outcomes in evaluation
    - Condition satisfied (i.e., outcome is TRUE) -> execute commands of "if"
    - Condition not satisfied (i.e., outcome is FALSE) -> execute commands of "else" (if any)
- if else statements can be nested


```{r eval=FALSE}
# General form
if(cond){
  statement for TRUE
}

# else is optional
if(cond){
  statement for TRUE
} else {
  statement for FALSE
} 
# bracket can be ignored too; 
# but I find it is easy to read with it

if(cond){
  statement for TRUE
} else {
  another if ... else ...
} 
```

```{r}
a <- 4
if (a %% 2 == 0) {
  b1 <- a * -1
}
a
b1
```

```{r}
a <- 5
if (a %% 2 == 0) {
  b <- a * -1
} else {
  b <- a ^ 2
}
b
```

```{r}
# nested if else
a <- 0.33
if (a %% 2 == 0) {
  b <- a * -1
} else {
  if (a %% 2 == 1) {
    b <- a ^ 2
  } else {
    b <- a * 10
  }
}
b
```

Why use if else statement?

- Useful for situations with multiple scenarios
- Define your own categories
- Case-by-case manipulation of data

```{r}
# Define your own categories
small <- 1:5
medium <- 6:10
large <- 11:15

a <- 2
if (a %in% small) {
  b <- 'Small number'
} else if (a %in% medium) {
  b <- 'Medium Number'
} else if (a %in% large) {
  b <- 'Large number'
} else {
  b <- 'Number out of range'
}
b

a <- 12
if (a %in% small) {
  b <- 'Small number'
} else {
  if (a %in% medium) {
    b <- 'Medium Number'
  } else {
    if (a %in% large) {
      b <- 'Large number'
    } else {
      b <- 'Number out of range'
    }
  }
} 
b
```

So if else is useful to work with one value/situation/condition/evaluation at each time.  What if we have multiple values/cases need to evaluate? 

- `ifelse()`
- combine with loops such as `for()` (next lecture)

# `ifelse()`



